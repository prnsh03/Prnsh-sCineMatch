{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "7f3c7dd5-d2b6-4621-93a9-55d18ee4d7a8",
   "metadata": {},
   "source": [
    "# Prnsh's CineMatch - A Movie Recommendation System"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "bcc12cc1-d0d1-43cd-88c4-80ba0a378b33",
   "metadata": {},
   "outputs": [],
   "source": [
    "import tkinter as tk\n",
    "from tkinter import messagebox, ttk\n",
    "import pandas as pd\n",
    "import random"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "704898a3-0ad9-44e7-8e2e-4cf913f0a8c9",
   "metadata": {},
   "outputs": [],
   "source": [
    "class MovieRecommendationSystem:\n",
    "    def __init__(self, csv_file):\n",
    "        self.movies = pd.read_csv(csv_file).to_dict(orient='records')\n",
    "        self.genre_weights = {\n",
    "            'Sci-Fi': 7,\n",
    "            'Action': 6,\n",
    "            'Drama': 5,\n",
    "            'Comedy': 4,\n",
    "            'Horror': 3,\n",
    "            'Romance': 2,\n",
    "            'Animation': 2,\n",
    "            'Thriller': 4\n",
    "        }\n",
    "        self.cast_weights = {\n",
    "            'A-list': 5,\n",
    "            'B-list': 3,\n",
    "            'C-list': 1\n",
    "        }\n",
    "        self.production_weights = {\n",
    "            'Arka Media Works': 5,\n",
    "            'Sun Pictures': 4.5,\n",
    "            'AGS Entertainment': 4.5,\n",
    "            'V Creations': 4.5,\n",
    "            'Lyca Productions': 4.5,\n",
    "            'Sathya Jyothi Films': 4,\n",
    "            'Thenandal Studio Limited': 4,\n",
    "            'Wunderbar Films': 4,\n",
    "            'Y NOT Studios': 4.5,\n",
    "            'Dream Warrior Pictures': 3.5,\n",
    "            'Madras Enterprises': 2,\n",
    "            '2D Entertainment': 4.5,\n",
    "            'Xavier Britto': 4.5,\n",
    "            'Axess Film Factory': 3.5,\n",
    "            'Potential Studios': 1,\n",
    "            'Thiagarajan Kumararaja': 3.5,\n",
    "            'Redhan The Cinema People': 1,\n",
    "            'Cameo Films India': 4\n",
    "        }\n",
    "        self.budget_weights = {\n",
    "            'High': 5,\n",
    "            'Medium': 3,\n",
    "            'Low': 1\n",
    "        }\n",
    "        self.box_office_weights = {\n",
    "            'Blockbuster': 5,\n",
    "            'Hit': 4,\n",
    "            'Average': 3,\n",
    "            'Flop': 1\n",
    "        }\n",
    "        self.budget_weights = {\n",
    "            'High': 5,\n",
    "            'Medium': 3,\n",
    "            'Low': 1\n",
    "        }\n",
    "        self.box_office_weights = {\n",
    "            'Blockbuster': 5,\n",
    "            'Hit': 4,\n",
    "            'Average': 3,\n",
    "            'Flop': 1\n",
    "        }\n",
    "\n",
    "    def add_movie(self, title, genre, cast_quality, production, budget, box_office, critical_acclaim):\n",
    "        rating = self.calculate_rating(genre, cast_quality, production, budget, box_office, critical_acclaim)\n",
    "        new_movie = {\n",
    "            'title': title,\n",
    "            'genre': genre,\n",
    "            'cast_quality': cast_quality,\n",
    "            'production': production,\n",
    "            'budget': budget,\n",
    "            'box_office': box_office,\n",
    "            'critical_acclaim': critical_acclaim,\n",
    "            'rating': rating\n",
    "        }\n",
    "        self.movies.append(new_movie)\n",
    "        self.ensure_unique_ratings()\n",
    "\n",
    "    def calculate_rating(self, genre, cast_quality, production, budget, box_office, critical_acclaim):\n",
    "        \"\"\"Calculate rating based on multiple factors.\"\"\"\n",
    "        genre_weight = self.genre_weights.get(genre, 0)\n",
    "        cast_weight = self.cast_weights.get(cast_quality, 0)\n",
    "        production_weight = self.production_weights.get(production, 0)\n",
    "        budget_weight = self.budget_weights.get(budget, 0)\n",
    "        box_office_weight = self.box_office_weights.get(box_office, 0)\n",
    "        \n",
    "        base_score = genre_weight + cast_weight + production_weight + budget_weight + box_office_weight + (critical_acclaim / 2)\n",
    "        \n",
    "        # Normalize to 10\n",
    "        max_score = 30  # Adjust max_score based on the sum of maximum weights\n",
    "        normalized_score = (base_score / max_score) * 10\n",
    "        \n",
    "        return normalized_score\n",
    "\n",
    "    def ensure_unique_ratings(self):\n",
    "        \"\"\"Ensure all ratings are unique by slightly adjusting them.\"\"\"\n",
    "        seen_ratings = {}\n",
    "        for movie in self.movies:\n",
    "            rating = movie['rating']\n",
    "            while rating in seen_ratings:\n",
    "                rating += random.uniform(-0.1, 0.1)\n",
    "            seen_ratings[rating] = True\n",
    "            movie['rating'] = rating\n",
    "\n",
    "    def search_movies(self, query, search_by='title'):\n",
    "        self.movies = self.quicksort(self.movies, key=search_by)  # Sort movies by the search key before searching\n",
    "        return self.binary_search(query, search_by)\n",
    "\n",
    "    def quicksort(self, movies, key='rating'):\n",
    "        if len(movies) <= 1:\n",
    "            return movies\n",
    "        pivot = movies[len(movies) // 2]\n",
    "        left = [x for x in movies if x[key] < pivot[key]]\n",
    "        middle = [x for x in movies if x[key] == pivot[key]]\n",
    "        right = [x for x in movies if x[key] > pivot[key]]\n",
    "        return self.quicksort(left, key) + middle + self.quicksort(right, key)\n",
    "\n",
    "    def binary_search(self, query, key='title'):\n",
    "        low, high = 0, len(self.movies) - 1\n",
    "        results = []\n",
    "        while low <= high:\n",
    "            mid = (low + high) // 2\n",
    "            if self.movies[mid][key].lower() == query.lower():\n",
    "                results.append(self.movies[mid])\n",
    "                # Check adjacent elements for multiple results\n",
    "                i = mid - 1\n",
    "                while i >= 0 and self.movies[i][key].lower() == query.lower():\n",
    "                    results.append(self.movies[i])\n",
    "                    i -= 1\n",
    "                i = mid + 1\n",
    "                while i < len(self.movies) and self.movies[i][key].lower() == query.lower():\n",
    "                    results.append(self.movies[i])\n",
    "                    i += 1\n",
    "                break\n",
    "            elif self.movies[mid][key].lower() < query.lower():\n",
    "                low = mid + 1\n",
    "            else:\n",
    "                high = mid - 1\n",
    "        return results\n",
    "\n",
    "    def recommend_movies(self, top_n):\n",
    "        sorted_movies = self.quicksort(self.movies)\n",
    "        return sorted_movies[:top_n]\n",
    "\n",
    "    def delete_movie(self, title):\n",
    "        self.movies = [movie for movie in self.movies if movie['title'].lower() != title.lower()]\n",
    "\n",
    "    def save_movies(self, csv_file):\n",
    "        df = pd.DataFrame(self.movies)\n",
    "        df.to_csv(csv_file, index=False)\n",
    "\n",
    "\n",
    "class MovieApp:\n",
    "    def __init__(self, root, system):\n",
    "        self.system = system\n",
    "        self.root = root\n",
    "        self.root.title(\"Movie Recommendation System\")\n",
    "\n",
    "        self.create_widgets()\n",
    "\n",
    "    def create_widgets(self):\n",
    "        # Add Movie\n",
    "        tk.Label(self.root, text=\"Add Movie\").grid(row=0, column=0, columnspan=2)\n",
    "\n",
    "        tk.Label(self.root, text=\"Title\").grid(row=1, column=0)\n",
    "        self.title_entry = tk.Entry(self.root)\n",
    "        self.title_entry.grid(row=1, column=1)\n",
    "\n",
    "        tk.Label(self.root, text=\"Genre\").grid(row=2, column=0)\n",
    "        self.genre_entry = tk.Entry(self.root)\n",
    "        self.genre_entry.grid(row=2, column=1)\n",
    "\n",
    "        tk.Label(self.root, text=\"Cast Quality\").grid(row=3, column=0)\n",
    "        self.cast_entry = tk.Entry(self.root)\n",
    "        self.cast_entry.grid(row=3, column=1)\n",
    "\n",
    "        tk.Label(self.root, text=\"Production\").grid(row=4, column=0)\n",
    "        self.production_entry = tk.Entry(self.root)\n",
    "        self.production_entry.grid(row=4, column=1)\n",
    "\n",
    "        tk.Label(self.root, text=\"Budget\").grid(row=5, column=0)\n",
    "        self.budget_entry = tk.Entry(self.root)\n",
    "        self.budget_entry.grid(row=5, column=1)\n",
    "\n",
    "        tk.Label(self.root, text=\"Box Office\").grid(row=6, column=0)\n",
    "        self.box_office_entry = tk.Entry(self.root)\n",
    "        self.box_office_entry.grid(row=6, column=1)\n",
    "\n",
    "        tk.Label(self.root, text=\"Critical Acclaim\").grid(row=7, column=0)\n",
    "        self.critical_entry = tk.Entry(self.root)\n",
    "        self.critical_entry.grid(row=7, column=1)\n",
    "\n",
    "        self.add_button = tk.Button(self.root, text=\"Add Movie\", command=self.add_movie)\n",
    "        self.add_button.grid(row=8, column=0, columnspan=2)\n",
    "\n",
    "        # Search Movie\n",
    "        tk.Label(self.root, text=\"Search Movie\").grid(row=9, column=0, columnspan=2)\n",
    "\n",
    "        tk.Label(self.root, text=\"Query\").grid(row=10, column=0)\n",
    "        self.search_entry = tk.Entry(self.root)\n",
    "        self.search_entry.grid(row=10, column=1)\n",
    "\n",
    "        self.search_by = tk.StringVar(value=\"title\")\n",
    "        tk.Radiobutton(self.root, text=\"Title\", variable=self.search_by, value=\"title\").grid(row=11, column=0)\n",
    "        tk.Radiobutton(self.root, text=\"Genre\", variable=self.search_by, value=\"genre\").grid(row=11, column=1)\n",
    "\n",
    "        self.search_button = tk.Button(self.root, text=\"Search\", command=self.search_movies)\n",
    "        self.search_button.grid(row=12, column=0, columnspan=2)\n",
    "\n",
    "        # Recommend Movies\n",
    "        tk.Label(self.root, text=\"Recommend Movies\").grid(row=13, column=0, columnspan=2)\n",
    "\n",
    "        tk.Label(self.root, text=\"Top N\").grid(row=14, column=0)\n",
    "        self.top_n_entry = tk.Entry(self.root)\n",
    "        self.top_n_entry.grid(row=14, column=1)\n",
    "\n",
    "        self.recommend_button = tk.Button(self.root, text=\"Recommend\", command=self.recommend_movies)\n",
    "        self.recommend_button.grid(row=15, column=0, columnspan=2)\n",
    "\n",
    "        # Delete Movie\n",
    "        tk.Label(self.root, text=\"Delete Movie\").grid(row=16, column=0, columnspan=2)\n",
    "\n",
    "        tk.Label(self.root, text=\"Title\").grid(row=17, column=0)\n",
    "        self.delete_entry = tk.Entry(self.root)\n",
    "        self.delete_entry.grid(row=17, column=1)\n",
    "\n",
    "        self.delete_button = tk.Button(self.root, text=\"Delete\", command=self.delete_movie)\n",
    "        self.delete_button.grid(row=18, column=0, columnspan=2)\n",
    "\n",
    "        # Result Area\n",
    "        self.result_text = tk.Text(self.root, height=10, width=50)\n",
    "        self.result_text.grid(row=19, column=0, columnspan=2)\n",
    "\n",
    "    def add_movie(self):\n",
    "        title = self.title_entry.get()\n",
    "        genre = self.genre_entry.get()\n",
    "        cast_quality = self.cast_entry.get()\n",
    "        production = self.production_entry.get()\n",
    "        budget = self.budget_entry.get()\n",
    "        box_office = self.box_office_entry.get()\n",
    "        critical_acclaim = float(self.critical_entry.get())\n",
    "        self.system.add_movie(title, genre, cast_quality, production, budget, box_office, critical_acclaim)\n",
    "        self.result_text.insert(tk.END, f\"Added: {title}\\n\")\n",
    "\n",
    "    def search_movies(self):\n",
    "        query = self.search_entry.get()\n",
    "        search_by = self.search_by.get()\n",
    "        results = self.system.search_movies(query, search_by)\n",
    "        self.result_text.delete(1.0, tk.END)\n",
    "        self.result_text.insert(tk.END, f\"Search results for '{query}' by {search_by}:\\n\")\n",
    "        if results:\n",
    "            for movie in results:\n",
    "                self.result_text.insert(tk.END, f\"{movie}\\n\")\n",
    "        else:\n",
    "            self.result_text.insert(tk.END, \"No results found.\\n\")\n",
    "\n",
    "    def recommend_movies(self):\n",
    "        top_n = int(self.top_n_entry.get())\n",
    "        results = self.system.recommend_movies(top_n)\n",
    "        self.result_text.delete(1.0, tk.END)\n",
    "        self.result_text.insert(tk.END, f\"Top {top_n} recommendations:\\n\")\n",
    "        for movie in results:\n",
    "            self.result_text.insert(tk.END, f\"{movie}\\n\")\n",
    "\n",
    "    def delete_movie(self):\n",
    "        title = self.delete_entry.get()\n",
    "        self.system.delete_movie(title)\n",
    "        self.result_text.insert(tk.END, f\"Deleted: {title}\\n\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "22967de6-c2ba-460e-9b56-90773d6c833a",
   "metadata": {},
   "outputs": [],
   "source": [
    "if __name__ == \"__main__\":\n",
    "    csv_file = \"tamil_movies.csv\" \n",
    "    system = MovieRecommendationSystem(csv_file)\n",
    "\n",
    "    root = tk.Tk()\n",
    "    app = MovieApp(root, system)\n",
    "    root.mainloop()\n",
    "\n",
    "    system.save_movies(csv_file)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "39940aff-6745-402a-87e8-29dc29291f20",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
